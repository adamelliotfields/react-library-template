<h1 align="center">
  React Library Template
</h1>

<!-- TODO: Update badges with your repository. -->
<p align="center">
  <a href="https://github.com/adamelliotfields/react-library-template/releases" target="_blank" rel="noopener noreferrer">
    <img src="https://img.shields.io/github/v/release/adamelliotfields/react-library-template?logo=github&color=brightgreen" alt="" />
  </a>
  <a href="https://github.com/adamelliotfields/react-library-template/actions" target="_blank" rel="noopener noreferrer">
    <img src="https://img.shields.io/github/workflow/status/adamelliotfields/react-library-template/build?logo=github" alt="build">
  </a>
  <a href="https://codeclimate.com/github/adamelliotfields/react-library-template" target="_blank" rel="noopener noreferrer">
    <img src="https://badgen.net/codeclimate/maintainability/adamelliotfields/react-library-template?icon=codeclimate&label=maintainability" alt="maintainability">
  </a>
  <a href="https://codeclimate.com/github/adamelliotfields/react-library-template" target="_blank" rel="noopener noreferrer">
    <img src="https://badgen.net/codeclimate/coverage/adamelliotfields/react-library-template?icon=codeclimate&label=coverage" alt="coverage">
  </a>
  <img src="https://badgen.net/dependabot/adamelliotfields/react-library-template?icon=dependabot&label=dependabot" alt="dependabot" />
</p>

> A template for building React libraries.

## Usage

This isn't a CLI tool like [`create-react-library`](https://github.com/transitive-bullshit/create-react-library).
It's merely a place to store configuration files so I may reference them in the future.

## Features

### Rollup

CJS, ES, and UMD bundles are emitted. The UMD bundle is minified.

### TypeScript

The [`tsconfig.json`](./tsconfig.json) is based on the one generated by [`create-react-app`](https://github.com/facebook/create-react-app/blob/v3.4.0/packages/react-scripts/scripts/utils/verifyTypeScriptSetup.js#L94).

[`rollup-plugin-typescrip2`](https://github.com/ezolenko/rollup-plugin-typescript2) is used to generate type declarations.

### Babel

The [`.babelrc`](./.babelrc) uses [`babel-preset-react-app`](https://github.com/facebook/create-react-app/tree/v3.4.0/packages/babel-preset-react-app).
Edit `.browserslistrc` to adjust which browsers you want to support.

### Jest

[`enzyme`](https://github.com/enzymejs/enzyme) and [`jest-enzyme`](https://github.com/FormidableLabs/enzyme-matchers/tree/master/packages/jest-enzyme)
are used for unit/integration testing.

### ESLint

The [`.eslintrc`](./.eslintrc) uses [`eslint-config-react-app`](https://github.com/facebook/create-react-app/tree/v3.4.0/packages/eslint-config-react-app)
with overrides from Prettier.

### Prettier

You can adjust [`.prettierrc`](./.prettierrc) and add any files you don't want beautified to [`.prettierignore`](./.prettierignore).

### Terser

The Terser options are imported directly from the Webpack config from [`react-scripts`](https://github.com/facebook/create-react-app/blob/v3.4.0/packages/react-scripts/config/webpack.config.js#L210).

### Storybook

Storybook uses the Webpack config from [`react-scripts`](https://github.com/facebook/create-react-app/blob/v3.4.0/packages/react-scripts/config/webpack.config.js).

The [`centered`](https://github.com/storybookjs/storybook/tree/master/addons/centered), [`knobs`](https://github.com/storybookjs/storybook/tree/master/addons/knobs)
and [`viewport`](https://github.com/storybookjs/storybook/tree/master/addons/viewport) addons are also included.

### GitHub Actions and Packages

There are multiple actions and steps in [`build.yml`](./build.yml).

When pushing or merging into `master`, a package will be published to this repository using GitHub
Packages. Update the `publishConfig` field in [`package.json`](./package.json) to publish to a
different registry. See [Semantic Release](#semantic-release) below.

### Semantic Release

[`semantic-release`](https://github.com/semantic-release/semantic-release) is used to generate
changelogs for releases automatically. If the version number is bumped, a package will be published.

You will need to create a GitHub [Personal Access Token](https://github.com/settings/tokens) with
`repo` and `packages` scopes and store it in a secret named `GH_TOKEN` in your repository.

Also, set `version` to `0.0.0-development` in [`package.json`](./package.json) and
[`packagep-lock.json`](./package-lock.json). `semantic-release` will automatically bump it to
`1.0.0` for your first release.

You should familiarize yourself with how `semantic-release` works, including the
[Angular Commit Message Format](https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#-git-commit-guidelines)
and the [default rules matching](https://github.com/semantic-release/commit-analyzer/blob/v8.0.1/README.md#default-rules-matching).

If you're not comfortable with the concept of [continuous delivery](https://continuousdelivery.com),
you should remove `semantic-release` from [`build.yml`](./.github/workflows/build.yml).

### Code Climate

[Code Climate](https://codeclimate.com/quality/pricing) is used for coverage and automated code
reviews. You'll need to create a free account and add your repository. Then, in your Code Climate
settings, copy your **Test Reporter ID** and store it in a secret named `CC_TEST_REPORTER_ID` in
in your repository.


Next, create a `.codeclimate.yml` file like below:

```yaml
version: '2'

checks:
  argument-count:
    enabled: true
    config: {}
  complex-logic:
    enabled: true
    config: {}
  file-lines:
    enabled: true
    config: {}
  method-complexity:
    enabled: true
    config: {}
  method-count:
    enabled: true
    config: {}
  method-lines:
    enabled: true
    config: {}
  nested-control-flow:
    enabled: true
    config: {}
  return-statements:
    enabled: true
    config: {}
  similar-code:
    enabled: true
    config: {}
  identical-code:
    enabled: true
    config: {}

plugins:
  duplication:
    enabled: true
    config: {}
  fixme:
    enabled: true
    config: {}

exclude_patterns:
  - coverage/
  - dist/
  - node_modules/
  - '**/*.d.ts'
```

Finally, add this step to `.github/workflows/build.yml` (below the `Test` step):

```yaml
- name: Code Climate
  run: |
    export GIT_COMMIT_SHA="$GITHUB_SHA"
    export GIT_BRANCH="${GITHUB_REF/refs\/heads\//}"
    sudo wget -qO /usr/local/bin/cc-test-reporter https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64
    sudo chmod +x /usr/local/bin/cc-test-reporter
    cc-test-reporter format-coverage -t lcov ./coverage/lcov.info
    cc-test-reporter upload-coverage
```

### Dependabot

Dependabot is used to keep your dependencies up-to-date. You just need to enable the
[Dependabot Preview](https://github.com/marketplace/dependabot-preview) app from GitHub Marketplace.

Then create a `.dependabot/config.yml` file like below:

```yaml
version: 1

update_configs:
  - package_manager: javascript
    directory: '/'
    update_schedule: weekly
    # TODO: If you are not me, you should use your own username.
    default_reviewers:
      - adamelliotfields
    default_labels:
      - dependabot
    ignored_updates:
      - match:
          dependency_name: react-scripts
```
